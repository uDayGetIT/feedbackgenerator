<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diamond Miner Website</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js"></script>
</head>
<body>
    <h1>Diamond Miner Website</h1>

    <!-- Connect MetaMask button -->
    <button onclick="connectMetaMask()">Connect MetaMask</button>

    <!-- Lock ETH section -->
    <h2>Lock ETH</h2>
    <label for="lockAmount">Enter ETH amount:</label>
    <input type="number" id="lockAmount" step="0.01" min="0" placeholder="0.00">
    <button onclick="lockETH()">Lock ETH</button>

    <!-- Claim Yield section -->
    <h2>Claim Yield</h2>
    <button onclick="claimYield()">Claim Yield</button>

    <script>
        // Replace with your contract address
        const contractAddress = "0x7ec0090f20224ed7DA4e71cb8b3Dc007f0b0F60B";
        // Replace with your contract ABI
        const contractABI = [ { "inputs": [], "name": "claimYield", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "uint256", "name": "_amount", "type": "uint256" } ], "name": "lockETH", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "address", "name": "_dminToken", "type": "address" }, { "internalType": "address", "name": "_owner", "type": "address" } ], "stateMutability": "nonpayable", "type": "constructor" }, { "inputs": [ { "internalType": "address", "name": "owner", "type": "address" } ], "name": "OwnableInvalidOwner", "type": "error" }, { "inputs": [ { "internalType": "address", "name": "account", "type": "address" } ], "name": "OwnableUnauthorizedAccount", "type": "error" }, { "anonymous": false, "inputs": [ { "indexed": true, "internalType": "address", "name": "user", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "amount", "type": "uint256" } ], "name": "ETHLocked", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "internalType": "address", "name": "previousOwner", "type": "address" }, { "indexed": true, "internalType": "address", "name": "newOwner", "type": "address" } ], "name": "OwnershipTransferred", "type": "event" }, { "inputs": [], "name": "renounceOwnership", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "uint256", "name": "_newValue", "type": "uint256" } ], "name": "setTotalValueLocked", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "uint256", "name": "_newPercentage", "type": "uint256" } ], "name": "setYieldPercentage", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "internalType": "address", "name": "newOwner", "type": "address" } ], "name": "transferOwnership", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "anonymous": false, "inputs": [ { "indexed": true, "internalType": "address", "name": "user", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "yieldAmount", "type": "uint256" } ], "name": "YieldClaimed", "type": "event" }, { "inputs": [ { "internalType": "address", "name": "_user", "type": "address" } ], "name": "calculateYield", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "dminToken", "outputs": [ { "internalType": "contract IERC20", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function" }, { "inputs": [ { "internalType": "address", "name": "", "type": "address" } ], "name": "lastYieldClaim", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function" }, { "inputs": [ { "internalType": "address", "name": "", "type": "address" } ], "name": "lockedETH", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "owner", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "totalValueLocked", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "yieldPercentage", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function" } ];
        // Replace with your RPC URL
        const rpcURL = "https://1rpc.io/sepolia";

        async function connectMetaMask() {
            if (window.ethereum) {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    console.log("MetaMask connected!");
                    // Call functions to interact with DiamondMiner contract
                } catch (error) {
                    console.error("Error connecting MetaMask:", error);
                }
            } else {
                console.error("MetaMask not found. Please install MetaMask.");
            }
        }

        async function lockETH() {
            const lockAmount = document.getElementById("lockAmount").value;

            if (!lockAmount || isNaN(lockAmount) || parseFloat(lockAmount) <= 0) {
                console.error("Invalid lock amount");
                return;
            }

            const provider = new ethers.providers.JsonRpcProvider(rpcURL);
            const signer = provider.getSigner();
            const contract = new ethers.Contract(contractAddress, contractABI, signer);

            try {
                const transaction = await contract.lockETH({ value: ethers.utils.parseEther(lockAmount) });
                await transaction.wait();
                console.log("ETH locked successfully!");
            } catch (error) {
                console.error("Error locking ETH:", error);
            }
        }

        async function claimYield() {
            const provider = new ethers.providers.JsonRpcProvider(rpcURL);
            const signer = provider.getSigner();
            const contract = new ethers.Contract(contractAddress, contractABI, signer);

            try {
                const transaction = await contract.claimYield();
                await transaction.wait();
                console.log("Yield claimed successfully!");
            } catch (error) {
                console.error("Error claiming yield:", error);
            }
        }
    </script>
</body>
</html>
